### 서울시 아파트 실거래가 예측 회귀분석 ML 개발 by Python
- Train 데이터셋 : 2007.10 ~ 2023.06
- Test 데이터셋 : 2023.07 ~ 2023.09

#### 1. Train 데이터셋에서 이상치 제거
[1] '층' <= 0 이면, 삭제 처리
[2] 'target' <= 10,000 이하 and '전용면적(㎡)' >= 60 이면, 삭제 처리
- target의 IQR을 확인하여 lower_bound 구간만 삭제하는 것과 비교검토하여 결정

#### 2. 결측치 등 데이터 전처리 
[1] Train과 Test 데이터셋 합치기
- 'test_yn' 컬럼을 추가하여 데이터 전처리 완료 후 다시 분리를 위하여 테스트 데이터셋 여부를 기록(test_yn == 1)

[2] 변수명 수정(특수 기호 제거)
- '전용면적(㎡)' -> '전용면적'
- 'k-전용면적별세대현황(60㎡이하)' -> 'k-전용면적(60이하)'
- 'k-전용면적별세대현황(60㎡~85㎡이하)' -> 'k-전용면적(60~85이하)'
- 'k-85㎡~135㎡이하' -> 'k-전용면적(85~135이하)'
- 'k-135㎡초과'-> 'k-전용면적(135이상)'

[3] 아파트 좌표X, 좌표Y 결측치 처리 
- 기 확보한 addr_xy.csv 파일에서 주소가 동일한 경우 X, Y를 추출하여 데이터셋에 반영
  단, 합친 데이터셋에서 X,Y 좌표가 빈 것을 대상으로만 수행  

[4] 결측치 처리
1. 결측치가 1,000,000개 이상인 컬럼 삭제
2. 'k-전용면적(135이상)' = int('k-전체세대수' - 'k-전용면적(60이하)' - 'k-전용면적(60~85이하)' - 'k-전용면적(85~135이하)')로 채워준다. 
  - **불필요 위1에서 이미 삭제됨**
3. 대부분 의미 없는 데이터(' ', '-' 등)로 채워져 있는 컬럼 삭제 : '등기신청일자', '거래유형', '중개사소재지' 
4. 변수 타입 수정
- 문자열로 변경 대상 : '본번', '부번' (우선 정수형으로 변경 후)
5. 결측치 보간 
- 범주형 변수 : .fillna('NULL')
- 연속형 변수(선형 보보) : .interpolate(method='linear', axis=0)

#### 3. 파생변수 생성
[1] 지역 변수 : **불필요 : '구', '동' 변수로 충분**
- 주소 분리 : '시군구' -> '구'와 '동'으로 분리 
- '프리미엄지역구분' : 1 (강남구, 서초구, 용산구), 2 (송파구, 성동구, 종로구, 마포구, 광진구), 3 (나머지 구)

[2] 시간 변수
- 계약년월 분리 : '계약년월' -> '계약년', '계약월'으로 분리
- '아파트나이' : '계약년' - '건축년도' (음수 방지)
- '신축' 여부 : 5년 이내 신축 (1) 또는 아님 (0)
- '노후' 여부 : 30년 이상 노후 (1) 또는 아님 (0)
- '재건축/리모델링' 여부 : 'k-시행사'에 '리모델링' 또는 '재건축' 문자열이 포함되어 있으면 1, 아니면 0 (신축 여부와 상관관계 확인 후 유지 여부 결정 필요)

[3] 면적 변경 : **불필요 : 전용면적으로 충분** 
- '평형' 구간 : bins=[0, 60, 85, 135, 1000], labels=['소형', '중형', '중대형', '대형']

[4] 단지 변수
- '대단지' 여부 : 'k-전체세대수' >= 500 이상이면 1, 아니면 0
- '브랜드아파트' 여부 : '아파트명'에 keyword_list = ['래미안', '힐스테이트', '자이', 'e편한세상', '푸르지오', '아이파크', 
    '더샵', '롯데캐슬', '디에이치', '센트럴', '파크', '트리', '포레']가 포함되어 있으면 1, 아니면 0
- '주상복합' 여부 : '아파트명'에 '주상복합'이 포함되어 있으면 1, 아니면 0

[5] 층고 변수
- '층고' : 5층 이하 '저층', 6 ~ 15층 '중층', 16층 이상 '고층서

[6] 역세권 변수
- 지하철역 좌표(subway_feature.csv)와 버스정류장 좌표(bus_feature.csv) 파일 활용
- np.radians 변환, Haversine 공식 활용하여 벡터화된 거리 계산
- '지하철역수_500m' : 아파트 좌표를 기준으로 반경 500m 이내의 지하철역 수 
- '버스정류소수_500m' : 아파트 좌표를 기준으로 반경 500m 이내의 버스정류장 수
- '역세권여부' : '지하철역수_500m' >= 1 이면 1, 아니면 0
- '교통편의성 점수' : '지하철역수_500m' * 3 + '버스정류소수_500m' * 0.5 

[7] 시차 변수 생성 : 최근 거래가 형성이 현재의 가격에 가장 근접하게 예측할 수 있기 때문에 고려한 변수 
- price_lag_1,2,3 : 1~3개월 전 가격
- price_rolling_mean_3 : 최근 3개월 이동평균
- nearby_region_avg : 인근 지역 평균 가격

#### 4. 불필요한 변수 삭제
[1] 삭제 대상
- [시군구, k-전화번호, k-팩스번호, 단지소개기존clob, k-세대타입(분양형태), k-관리방식, k-사용검사일-사용승인일, k-홈페이지, k-등록일자, k-수정일자,  고용보험관리번호, 경비비관리형태, 세대전기계약방법, 청소비관리형태, 기타/의무/임대/임의=1/2/3/4, 단지승인일, 사용허가여부, 관리비 업로드, 단지신청일]
[2] 상관관계 분석 후 삭제 대상 선정
- 추가적으로 불필요한 변수는 삭제 대상 : 
  ['번지', '본번', '부번', '아파트명', '도로명', '해제사유발생일', '계약일']
- 상관관계 히트맵 확인 후 추가 삭제 대상 :
  ['계약년월', 'k-전용면적별세대현황(60이하)', 'k-전용면적별세대현황(60~85이하)', 'k-전용면적별세대현황(85~135이하)', 'k-전용면적별세대현황(135이상)', 'k-주거전용면적', 'K-관리비부과면적', 'k-전체동수']

#### 5. Train과 Test 데이터셋 분리
- 'test_yn'을 기준으로 분리 

#### 6. 고려 사항
- Right Skewness 분포에 의한 왜곡을 축소하기 위해서 target변수 np.log1p() 변환 고려 
- 'k-복도유형', 'k-난방방식' 변수가 가격에 영향을 미치는지는 상관계수로 확인 후 결성 